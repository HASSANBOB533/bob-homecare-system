{
  "query": "CREATE TABLE IF NOT EXISTS `rewards` (\n  `id` int AUTO_INCREMENT NOT NULL,\n  `name` varchar(255) NOT NULL,\n  `nameEn` varchar(255) NOT NULL,\n  `description` text,\n  `descriptionEn` text,\n  `pointsCost` int NOT NULL,\n  `discountType` enum('percentage','fixed','free_service') NOT NULL,\n  `discountValue` int,\n  `serviceId` int,\n  `active` boolean DEFAULT true NOT NULL,\n  `createdAt` timestamp NOT NULL DEFAULT (now()),\n  `updatedAt` timestamp NOT NULL DEFAULT (now()) ON UPDATE CURRENT_TIMESTAMP,\n  CONSTRAINT `rewards_id` PRIMARY KEY(`id`),\n  CONSTRAINT `rewards_serviceId_services_id_fk` FOREIGN KEY (`serviceId`) REFERENCES `services`(`id`) ON DELETE set null ON UPDATE no action\n);\n\nCREATE TABLE IF NOT EXISTS `loyaltyTransactions` (\n  `id` int AUTO_INCREMENT NOT NULL,\n  `userId` int NOT NULL,\n  `points` int NOT NULL,\n  `type` enum('earned','redeemed','bonus','penalty') NOT NULL,\n  `bookingId` int,\n  `rewardId` int,\n  `description` text,\n  `createdAt` timestamp NOT NULL DEFAULT (now()),\n  CONSTRAINT `loyaltyTransactions_id` PRIMARY KEY(`id`),\n  CONSTRAINT `loyaltyTransactions_userId_users_id_fk` FOREIGN KEY (`userId`) REFERENCES `users`(`id`) ON DELETE cascade ON UPDATE no action,\n  CONSTRAINT `loyaltyTransactions_bookingId_bookings_id_fk` FOREIGN KEY (`bookingId`) REFERENCES `bookings`(`id`) ON DELETE set null ON UPDATE no action,\n  CONSTRAINT `loyaltyTransactions_rewardId_rewards_id_fk` FOREIGN KEY (`rewardId`) REFERENCES `rewards`(`id`) ON DELETE set null ON UPDATE no action\n);\n\nCREATE TABLE IF NOT EXISTS `redemptions` (\n  `id` int AUTO_INCREMENT NOT NULL,\n  `userId` int NOT NULL,\n  `rewardId` int,\n  `bookingId` int,\n  `pointsSpent` int NOT NULL,\n  `status` enum('pending','applied','cancelled') DEFAULT 'pending' NOT NULL,\n  `createdAt` timestamp NOT NULL DEFAULT (now()),\n  `updatedAt` timestamp NOT NULL DEFAULT (now()) ON UPDATE CURRENT_TIMESTAMP,\n  CONSTRAINT `redemptions_id` PRIMARY KEY(`id`),\n  CONSTRAINT `redemptions_userId_users_id_fk` FOREIGN KEY (`userId`) REFERENCES `users`(`id`) ON DELETE cascade ON UPDATE no action,\n  CONSTRAINT `redemptions_rewardId_rewards_id_fk` FOREIGN KEY (`rewardId`) REFERENCES `rewards`(`id`) ON DELETE set null ON UPDATE no action,\n  CONSTRAINT `redemptions_bookingId_bookings_id_fk` FOREIGN KEY (`bookingId`) REFERENCES `bookings`(`id`) ON DELETE set null ON UPDATE no action\n);\n\nALTER TABLE `users` ADD COLUMN IF NOT EXISTS `loyaltyPoints` int DEFAULT 0 NOT NULL;",
  "command": "mysql --batch --raw --column-names --default-character-set=utf8mb4 --host gateway02.us-east-1.prod.aws.tidbcloud.com --port 4000 --user 2j9NYXgTnYir7Mh.root --database Htf64TWdaDvosPeCL5WWib --execute CREATE TABLE IF NOT EXISTS `rewards` (\n  `id` int AUTO_INCREMENT NOT NULL,\n  `name` varchar(255) NOT NULL,\n  `nameEn` varchar(255) NOT NULL,\n  `description` text,\n  `descriptionEn` text,\n  `pointsCost` int NOT NULL,\n  `discountType` enum('percentage','fixed','free_service') NOT NULL,\n  `discountValue` int,\n  `serviceId` int,\n  `active` boolean DEFAULT true NOT NULL,\n  `createdAt` timestamp NOT NULL DEFAULT (now()),\n  `updatedAt` timestamp NOT NULL DEFAULT (now()) ON UPDATE CURRENT_TIMESTAMP,\n  CONSTRAINT `rewards_id` PRIMARY KEY(`id`),\n  CONSTRAINT `rewards_serviceId_services_id_fk` FOREIGN KEY (`serviceId`) REFERENCES `services`(`id`) ON DELETE set null ON UPDATE no action\n);\n\nCREATE TABLE IF NOT EXISTS `loyaltyTransactions` (\n  `id` int AUTO_INCREMENT NOT NULL,\n  `userId` int NOT NULL,\n  `points` int NOT NULL,\n  `type` enum('earned','redeemed','bonus','penalty') NOT NULL,\n  `bookingId` int,\n  `rewardId` int,\n  `description` text,\n  `createdAt` timestamp NOT NULL DEFAULT (now()),\n  CONSTRAINT `loyaltyTransactions_id` PRIMARY KEY(`id`),\n  CONSTRAINT `loyaltyTransactions_userId_users_id_fk` FOREIGN KEY (`userId`) REFERENCES `users`(`id`) ON DELETE cascade ON UPDATE no action,\n  CONSTRAINT `loyaltyTransactions_bookingId_bookings_id_fk` FOREIGN KEY (`bookingId`) REFERENCES `bookings`(`id`) ON DELETE set null ON UPDATE no action,\n  CONSTRAINT `loyaltyTransactions_rewardId_rewards_id_fk` FOREIGN KEY (`rewardId`) REFERENCES `rewards`(`id`) ON DELETE set null ON UPDATE no action\n);\n\nCREATE TABLE IF NOT EXISTS `redemptions` (\n  `id` int AUTO_INCREMENT NOT NULL,\n  `userId` int NOT NULL,\n  `rewardId` int,\n  `bookingId` int,\n  `pointsSpent` int NOT NULL,\n  `status` enum('pending','applied','cancelled') DEFAULT 'pending' NOT NULL,\n  `createdAt` timestamp NOT NULL DEFAULT (now()),\n  `updatedAt` timestamp NOT NULL DEFAULT (now()) ON UPDATE CURRENT_TIMESTAMP,\n  CONSTRAINT `redemptions_id` PRIMARY KEY(`id`),\n  CONSTRAINT `redemptions_userId_users_id_fk` FOREIGN KEY (`userId`) REFERENCES `users`(`id`) ON DELETE cascade ON UPDATE no action,\n  CONSTRAINT `redemptions_rewardId_rewards_id_fk` FOREIGN KEY (`rewardId`) REFERENCES `rewards`(`id`) ON DELETE set null ON UPDATE no action,\n  CONSTRAINT `redemptions_bookingId_bookings_id_fk` FOREIGN KEY (`bookingId`) REFERENCES `bookings`(`id`) ON DELETE set null ON UPDATE no action\n);\n\nALTER TABLE `users` ADD COLUMN IF NOT EXISTS `loyaltyPoints` int DEFAULT 0 NOT NULL;",
  "rows": [],
  "messages": [],
  "stdout": "",
  "stderr": "",
  "execution_time_ms": 67
}